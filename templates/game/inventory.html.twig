{% extends 'base.html.twig' %}

{% block title %}Inventaire{% endblock %}

{% block body %}
<div class="inventory-wrapper container mt-4" style="max-width:1400px; width:100%;">

    <!-- Barre sup√©rieure : titre + or + bouton ajouter -->
    <div class="d-flex justify-content-between align-items-center mb-4 p-3 rounded shadow-sm" style="background-color: #1e1e2f; color: #fff;">
        <h1 style="margin:0;">Inventaire</h1>

        <div class="d-flex align-items-center">
            <!-- Encadr√© Or RPG dynamique -->
            {% set goldColor = 'danger' %}
            {% if hero.gold >= 100 %}
                {% set goldColor = 'success' %}
            {% elseif hero.gold >= 50 %}
                {% set goldColor = 'warning' %}
            {% endif %}

            <div class="d-flex align-items-center me-3 p-2 rounded" style="background-color: #3a3a5c; gap:5px;">
                <form method="post" action="{{ path('inventory_update_gold', {'heroId': hero.id}) }}" class="d-flex align-items-center">
                    <input type="number" id="gold" name="gold" 
                           value="{{ hero.gold }}" 
                           min="0" class="form-control form-control-sm me-2" style="width:80px;">
                    <input type="hidden" name="_token" value="{{ csrf_token('update_gold') }}">
                    <button type="submit" class="btn btn-{{ goldColor }} btn-xs" style="font-size:0.8rem; padding:0.25rem 0.5rem;">
                        <i class="fa-solid fa-coins"></i>
                    </button>
                </form>
            </div>

            <!-- Bouton ajouter un objet -->
            <a href="{{ path('inventory_new', {'heroId': hero.id}) }}" class="btn btn-primary btn-sm">‚ûï Ajouter un objet</a>
        </div>
    </div>

    <!-- Messages de succ√®s ou d'erreur -->
    {% for label, messages in app.flashes %}
        {% for message in messages %}
            <div class="alert alert-{{ label }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        {% endfor %}
    {% endfor %}

    <!-- Liste des objets avec espacement fixe de 3px et zone √©largie -->
    <div class="d-flex flex-wrap" style="gap:3px; width:100%;">
        {% for item in items|default([]) %}
            <div style="flex:1 1 calc(25% - 2px); min-width:180px;">
                <div class="card shadow-sm" style="background-color:#2a2a3f; color:#fff; margin:0;">
                    <div class="card-body d-flex flex-column justify-content-between p-2">
                        <div>
                            <h5 class="card-title mb-1">{{ item.name }}</h5>
                            <p class="card-text mb-1"><strong>Description :</strong> {{ item.description }}</p>
                            {% if item.additionalInfo %}
                                <p class="card-text mb-1"><strong>Infos :</strong> {{ item.additionalInfo }}</p>
                            {% endif %}
                        </div>
                        <div class="mt-2 d-flex justify-content-end">
                            <a href="{{ path('inventory_edit', {'id': item.id}) }}" 
                               class="btn btn-warning btn-sm me-1" aria-label="Modifier {{ item.name }}">‚úèÔ∏è</a>

                            <form method="post" action="{{ path('inventory_delete', {'id': item.id}) }}" 
                                  class="d-inline" onsubmit="return confirm('Supprimer cet objet ?');">
                                <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ item.id) }}">
                                <button type="submit" class="btn btn-danger btn-sm" aria-label="Supprimer {{ item.name }}">üóëÔ∏è</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        {% else %}
            <p style="margin:3px;">Aucun objet dans l'inventaire.</p>
        {% endfor %}
    </div>
</div>
{% endblock %}
