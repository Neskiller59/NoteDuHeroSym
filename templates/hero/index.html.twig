{% extends 'base.html.twig' %}

{% block title %}Bienvenue, Aventurier{% endblock %}

{% block body %}
<div class="container mt-4">

    {% if app.user %}
        <h1>Bienvenue, {{ app.user.username }}</h1>
        <p>Voici vos héros :</p>

        {% if heroes|length > 0 %}
            <div class="row g-3">

                {% for hero in heroes %}
                    <div class="col-md-6 col-lg-4">
                        <div class="card shadow-sm p-3" style="background-color:#2a2a3f; color:#fff;">

                            <h5>{{ hero.name }}</h5>

                            {% if hero.photo %}
                                <img src="{{ hero.photo }}" alt="{{ hero.name }}" class="img-fluid mb-2 rounded">
                            {% endif %}

                            <p><strong>Univers : </strong>{{ hero.universe ?? 'Inconnu' }}</p>

                            {% if hero.additionalInfo %}
                                <p>{{ hero.additionalInfo }}</p>
                            {% endif %}

                            <!-- Boutons d’action -->
                            <div class="mt-3 d-flex gap-2">

                                <!-- Sélectionner -->
                                <a class="btn btn-primary btn-sm"
                                   href="{{ path('app_home', { hero_id: hero.id }) }}">
                                    Sélectionner
                                </a>

                                <!-- Inventaire du héros -->
                                <a class="btn btn-warning btn-sm"
                                   href="{{ path('hero_inventory', { id: hero.id }) }}">
                                    Inventaire
                                </a>

                                <!-- Journal de quête -->
                                <a class="btn btn-info btn-sm"
                                   href="{{ path('hero_quests', { id: hero.id }) }}">
                                    Quêtes
                                </a>

                                <!-- Supprimer -->
                                <form method="POST"
                                      action="{{ path('hero_delete', { id: hero.id }) }}"
                                      onsubmit="return confirm('Supprimer ce héros ?')">
                                    <input type="hidden" name="_token"
                                           value="{{ csrf_token('delete' ~ hero.id) }}">
                                    <button class="btn btn-danger btn-sm">X</button>
                                </form>

                            </div>

                        </div>
                    </div>
                {% endfor %}
            </div>

        {% else %}
            <p>Vous n'avez pas encore de héros. <a href="{{ path('hero_new') }}">Créer un héros</a></p>
        {% endif %}

    {% else %}
        <p>Vous devez être connecté pour voir vos héros.</p>
    {% endif %}
</div>
{% endblock %}
